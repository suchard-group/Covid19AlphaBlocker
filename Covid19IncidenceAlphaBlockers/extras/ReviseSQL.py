import glob, sys, os

(old_dir,new_dir) = sys.argv[1:3]

for in_file in glob.glob(old_dir + 'COVID_ACE_ID*.sql'):
	print "Sql:", in_file
	out_file = new_dir + '/' + os.path.basename(in_file)
	print "Sql:", out_file

 	fin = open(in_file, "rt")
 	fout = open(out_file, "wt")

	for line in fin:
		fout.write(line.
		# [LEGEND] ACE inhibitors
    replace('(1340128,1341927,1363749,1308216,1373225,1334456,1335471,1310756,1331235,1342439)',
            '(1308216,1310756,1331235,1334456,1335471,1340128,1341927,1342001,1342439,1363749,1373225,19040051,19050216,19102107,19122327,45775374,45775375,45775527,45775529,45775539,45775544)').
		# [LEGEND] ACE inhibitors & ARBs
    replace('(1340128,1341927,1363749,1308216,1367500,1373225,1334456,40235485,1335471,1351557,1346686,1347384,1310756,40226742,1331235,1317640,1342439,1308842)',
            '(1340128,1341927,1363749,1308216,1367500,1373225,1334456,40235485,1335471,1351557,1346686,1347384,1310756,40226742,1331235,1317640,1342439,1308842,1342001,19040051,19050216,19102107,19122327,45775374,45775375,45775527,45775529,45775539,45775544)').
    # [LEGEND] dCCBs and thiazides/thiazide-like diuretics
    replace('(1332418,1395058,1353776,974166,978555,1326012,907013,1318137,1318853,1319880)',
            '(1332418,1395058,1353776,974166,978555,1326012,907013,1318137,1318853,1319880,1319133,19020061,19089969,19004539,19015802,19071995,19102106,19113063,1316354,19010493)').
	  # [LEGEND] Thiazide or thiazide-like diuretics
    replace('(1395058,974166,978555,907013)',
            '(1395058,974166,978555,907013,1316354,19010493)').
    # [LEGEND] Dihydropyridine calcium channel blockers (dCCB)
    replace('(1332418,1353776,1326012,1318137,1318853,1319880)',
            '(1332418,1353776,1326012,1318137,1318853,1319880,1319133,19020061,19089969,19004539,19015802,19071995,19102106,19113063)').
    # [LEGEND] Beta-blockers (BB)
    replace('(1319998,1314002,1322081,1338005,1386957,1307046,1313200,1327978,1345858,1353766,1346823,1314577)',
            '(1319998,1314002,1322081,1338005,1386957,1307046,1313200,1327978,1345858,1353766,1346823,1314577,902427,905531,932815,950370,1370109,19018489,19018640,19024904,19049145,19063575,19081284,19100435,19100451)').
    # [LEGEND] ndCCB            
    replace('(1328165,1307863)',
            '(1328165,1307863,19057715)'))
	fin.close()
	fout.close()
